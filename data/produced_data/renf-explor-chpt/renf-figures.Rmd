---
title: "Renfrewshire exploratory project figures"
author: "David Henderson"
date: "23 January 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:/GitHub/thesis_rmd')
```

# Introduction

Much of the output from analysis on the renfrew data is in a report I produced in the safe haven. A copy of which is in the `assets` folder of the `thesis_rmd` R project under the filename `001_renfrew_interim_01_2017-12-11`. 

Some of the data in tabular form I'd like to show as figures so will create these here. 

##Packages

```{r packages, warning=FALSE, message=FALSE}
library(tidyverse)
library(cowplot)
```

#Create tables

## hc_type

The first table in a count of individuals receving each type of care

```{r type}
hc_type_table <-
  tribble(~hc_type, ~n, ~percent,
          "Care at Home (Mainstream)", 32054, 0.84,
          "Reablement", 4535, 0.12,
          "Rapid Response", 1720, 0.04,
          "Community Mental Health", 28, 0.00)
hc_type_table$hc_type <- factor(hc_type_table$hc_type)
  
```

And a figure of this

```{r type_fig}
renf_type_fig <-
  hc_type_table %>% 
  ggplot(aes(fct_reorder(hc_type, -n), n, colour = fct_reorder(hc_type, -n))) +
  geom_point(size = 3) +
  geom_text(data = hc_type_table, aes(label=paste0(percent * 100,"%"), x= hc_type,
                            y= n), size=3.5, vjust = -0.8, colour = "black") +
  theme(axis.text.x = element_blank()) +
  expand_limits(y = 35000) +
  labs(
    y = "Number of packages",
    x = "",
    colour = "Type of home care"
  ) +
  scale_colour_manual(values = ubdc_palette)
  
renf_type_fig
```

save it

```{r save, eval=FALSE}
ggsave(filename = "data/produced_data/renf-explor-chpt/renf-type-fig.png", renf_type_fig,
       height = 4, width = 8)
```


##Hours of care

Derive from table on page 18 of the report

```{r hours}
hrs_table <-
  tribble(~hrs_group, ~n,
          "0-<5", 15365,
          "5-<10", 12935,
          "10-<15", 6586,
          "15-<20", 2800,
          "over 20", 514,
          "Missing data", 137) %>% 
  mutate(pct = n/sum(n) * 100)

hrs_table$hrs_group <- factor(hrs_table$hrs_group)

```

and plot

```{r hrs_fig}
renf_hrs_fig <-
  hrs_table %>% 
  ggplot(aes(fct_reorder(hrs_group, -n), n, colour = hrs_group)) +
  geom_point(size = 3) +
  geom_text(data = hrs_table, aes(label=paste0(round(pct, 1),"%"), x= hrs_group,
                            y= n), size=3.5, vjust = -0.8, colour = "black") +
  theme(legend.position = "none") +
  expand_limits(y = 18000) +
  labs(
    y = "Number of packages",
    x = "Hours of home care"
  ) +
  scale_colour_manual(values = ubdc_palette)
  
renf_hrs_fig
```

and save

```{r save_2, eval=FALSE}
ggsave(filename = "data/produced_data/renf-explor-chpt/renf-hrs-fig.png", renf_hrs_fig,
       height = 4, width = 6)
```


